---
title: "Salary Prediction"
author: "R.M. Palmer"
date: "11/18/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(caret)
library(leaps)
library(MASS)
library(relaimpo)
library(car)
library(glmnet)
```

```{r child = 'dataload.Rmd'}
```

```{r lm_common}
numeric_predictors <- c("Age",
"DistanceFromHome",
"Education",
"EnvironmentSatisfaction",
"JobInvolvement",
"JobLevel",
"JobSatisfaction",
"NumCompaniesWorked",
"PercentSalaryHike",
"PerformanceRating",
"RelationshipSatisfaction",
"StockOptionLevel",
"TotalWorkingYears",
"TrainingTimesLastYear",
"WorkLifeBalance",
"YearsAtCompany",
"YearsInCurrentRole",
"YearsSinceLastPromotion",
"YearsWithCurrManager")

factor_predictors <- c("BusinessTravel",
"Department",
"EducationField",
"Gender",
"JobRole",
"MaritalStatus")

all_predictors <- c(factor_predictors,numeric_predictors)

mi_f_all <- as.formula(paste("MonthlyIncome ~ ",paste(all_predictors,collapse="+")))
mi_f_num <- as.formula(paste("MonthlyIncome ~ ",paste(numeric_predictors,collapse="+")))
mi_f_fac <- as.formula(paste("MonthlyIncome ~ ",paste(factor_predictors,collapse="+")))

selected_by_stepwise <- c("BusinessTravel",
"Gender",
"JobRole",
"DistanceFromHome",
"JobLevel",
"PercentSalaryHike",
"PerformanceRating",
"TotalWorkingYears",
"YearsSinceLastPromotion",
"YearsWithCurrManager)

mi_f_sel <- as.formula(paste("MonthlyIncome ~ ",paste(all_predictors,collapse="+")))

```

```{r loocv}
train_control <- trainControl(method="LOOCV")
salary_loocv <- train(mi_f_sel,
                      data=employee_data,
                      method="lm",trControl = train_control)
print(salary_loocv)
```